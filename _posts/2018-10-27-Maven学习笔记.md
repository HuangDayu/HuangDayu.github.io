---
title: Maven学习笔记
date: 2018-10-27 16:16:46
category: 
- 研讨技术
tags:
- Maven
permalink: /blog/21
---

# 检索冲突的依赖

比如 log4j-over-slf4j 和 slf4j-log4j12 冲突   

- slf4j-log4j12的groupId是org.slf4j  
- slf4j-log4j12的artifactId是slf4j-log4j12  


```sehll
mvn dependency:tree -Dverbose -Dincludes=org.slf4j:slf4j-log4j12
```

解决   

```xml
<dependency> 
  <groupId>org.apache.zookeeper</groupId>  
  <artifactId>zookeeper</artifactId>  
  <version>3.4.8</version>  
  <exclusions> 
    <exclusion> 
      <groupId>org.slf4j</groupId>  
      <artifactId>slf4j-log4j12</artifactId> 
    </exclusion>  
    <exclusion> 
      <groupId>log4j</groupId>  
      <artifactId>log4j</artifactId> 
    </exclusion> 
  </exclusions> 
</dependency>
```

# 打包成可运行jar

Main.java   

```java
package cn.huangdayu.falsework.provider.main;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class Main {
	
	private static Logger logger = LoggerFactory.getLogger(Main.class);
    
    public static void main(String[] args) {
        try {
        	ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("classpath:spring/applicationContext.xml");
            context.start();
            System.in.read();
        } catch (Exception e) {
        	logger.error(" Dubbo provider context start error:",e.getMessage());
        }
        synchronized (Main.class) {
            while (true) {
                try {
                	Main.class.wait();
                } catch (InterruptedException e) {
                	logger.error("synchronized error:",e.getMessage());
                }
            }
        }
    }
}
```

<!-- more -->

pom.xml  

```xml
<build> 
  <finalName>falsework-provider</finalName>  
  <plugins> 
    <plugin> 
      <groupId>org.apache.maven.plugins</groupId>  
      <artifactId>maven-shade-plugin</artifactId>  
      <version>1.7</version>  
      <executions> 
        <execution> 
          <phase>package</phase>  
          <goals> 
            <goal>shade</goal> 
          </goals>  
          <configuration> 
            <finalName>falsework-provider-app</finalName>  
            <shadedArtifactAttached>true</shadedArtifactAttached>  
            <shadedClassifierName>jar-with-dependencies</shadedClassifierName>  
            <transformers> 
              <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"> 
                <mainClass>cn.huangdayu.falsework.provider.main.Main</mainClass> 
              </transformer>  
              <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer"> 
                <resource>META-INF/spring.handlers</resource> 
              </transformer>  
              <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer"> 
                <resource>META-INF/spring.schemas</resource> 
              </transformer>  
              <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer"> 
                <resource>META-INF/spring.tooling</resource> 
              </transformer> 
            </transformers> 
          </configuration> 
        </execution> 
      </executions> 
    </plugin> 
  </plugins> 
</build>
```

后台运行  

```shell
nohup java -Ddubbo.service.server.port=20880 -jar falsework-provider-app.jar > 2018-10-27-falsework-provider-app.log &
```